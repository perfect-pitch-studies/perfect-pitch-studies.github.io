<!DOCTYPE html>
<html>
  <head>
    <title>TestScript</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="jspsych-4.3/jspsych.js"></script>
    <script src="jspsych-4.3/plugins/jspsych-text.js"></script>
    <script src="jspsych-4.3/plugins/jspsych-single-stim.js"></script>
    <link href="jspsych-4.3/css/jspsych.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <script>
      var experiment = [];

    // generate a random subject ID
	  var subject_id = Math.floor(Math.random()*100000);
	  
    //Welcome text
      var welcome_text = {
        type: "text",
        text: '<p>Welcome to the experiment. </p><p>Before we begin, please turn up the brightness and volume on your computer.</p><p>Press enter to continue.</p>',
        timing_post_trial: 0
      };
	  
	  experiment.push(welcome_text);
	  
	//Encoding Instructions
      var enc_instruction_text = {
        type: "text",
        text: '<p>This is an experiment about remembering movies.</p><p>You will first watch several short ' +
		'clips taken from movies.</p><p>You will then be presented with excerpts from these clips and asked ' + 
		'a question about them.</p><p>When you are ready to begin the experiment, press ENTER.</p>',
        timing_post_trial: 0
      };
      
	  experiment.push(enc_instruction_text);
      
    //Encoding  
	  var vid_stimuli = [
		'<video src="CasablancaSourceClips/1.mp4" controls autoplay></video>',
		'<video src="CasablancaSourceClips/3.mp4" controls autoplay></video>',
		'<video src="CasablancaSourceClips/5.mp4" controls autoplay></video>',
		'<video src="CasablancaSourceClips/7.mp4" controls autoplay></video>',
		'<video src="CasablancaSourceClips/9.mp4" controls autoplay></video>',
		'<video src="CasablancaSourceClips/11.mp4" controls autoplay></video>',
		'<video src="CasablancaVideoTargets/t13.mp4" controls autoplay></video>',
		'<video src="CasablancaVideoTargets/t15.mp4" controls autoplay></video>',
		'<video src="CasablancaVideoTargets/t17.mp4" controls autoplay></video>',
		'<video src="CasablancaVideoTargets/t19.mp4" controls autoplay></video>',
		'<video src="CasablancaVideoTargets/t21.mp4" controls autoplay></video>',
		'<video src="CasablancaVideoTargets/t23.mp4" controls autoplay></video>'
	  ];

	  var rand_vid_trials = jsPsych.randomization.repeat(vid_stimuli,1);
      
	  for(var i=0; i < rand_vid_trials.length; i++){
      
	  var video_encoding = {
        type: "single-stim",
        stimuli: [rand_vid_trials[i]],
        is_html: true,
        timing_response: 32000,
        response_ends_trial: false
      };
      
  	  var continue_text = {
        type: "text",
        text: '<p>To continue to the next video, press ENTER.</p>',
        timing_post_trial: 0
      };
  
  
       experiment.push(video_encoding);
  	   experiment.push(continue_text);
  
	  }

	//Retrieval Instructions
      var ret_instruction_text = {
        type: "text",
        text: '<p>This is an experiment about remembering movies.</p><p>You will now be presented with still images from these clips and asked if you have previously seen the clip from which the image is taken.</p><p>If yes, press Q on the keyboard. If no, press P on the keyboard</p><p>When you are ready to begin the experiment, press ENTER.</p>',
        timing_post_trial: 0
      };
      
	  experiment.push(ret_instruction_text);
	 
	//Retrieval 
	  var still_stimuli = [
		{
			image: "Stills/1.bmp",
			data: {response: 'old-music'}
		},
		{
			image: "Stills/3.bmp",
			data: {response: 'old-music'}
		},
		{
			image: "Stills/5.bmp",
			data: {response: 'old-music'}
		},
		{
			image: "Stills/7.bmp",
			data: {response: 'old-music'}
		},
		{
			image: "Stills/9.bmp",
			data: {response: 'old-music'}
		},
		{
			image: "Stills/11.bmp",
			data: {response: 'old-music'}
		},
		{
			image: "Stills/13.bmp",
			data: {response: 'old-silent'}
		},
		{
			image: "Stills/15.bmp",
			data: {response: 'old-silent'}
		},
		{
			image: "Stills/17.bmp",
			data: {response: 'old-silent'}
		},
		{
			image: "Stills/19.bmp",
			data: {response: 'old-silent'}
		},
		{
			image: "Stills/21.bmp",
			data: {response: 'old-silent'}
		},
		{
			image: "Stills/23.bmp",
			data: {response: 'old-silent'}
		},
		{
			image: "Stills/2.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/4.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/6.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/8.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/10.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/12.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/14.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/16.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/18.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/20.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/22.bmp",
			data: {response: 'new'}
		},
		{
			image: "Stills/24.bmp",
			data: {response: 'new'}
		},
	  ];
	  
	  var rand_still_trials = jsPsych.randomization.repeat(still_stimuli,1,true);
	  
      var still = {
        type: "single-stim",
        stimuli: rand_still_trials.image,
        prompt: '<p>Did you see this movie clip? If yes, press Q on the keyboard. If no, press P on the keyboard</p>',
		data: rand_still_trials.data,
		choices: ['Q','P']
      };
      
      experiment.push(still);

      //Retrieval Instructions
      var finish_text = {
        type: "text",
        text: '<p>Thank you for participating.</p><p>To exit the experiment, press ENTER.</p>',
        timing_post_trial: 0
      };

      experiment.push(finish_text);

      jsPsych.data.addProperties({subject: subject_id});
      
      jsPsych.init({
        experiment_structure: experiment,
        on_finish: function() {
        jsPsych.data.displayData('csv');
   		}
      });
    </script>
  </body>
</html>